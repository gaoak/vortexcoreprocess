%%
clear;
clc;
close all;
setPlotParameters;
%%
endpointz = [4.02651246704487	4.0329521644097	4.04124285214938	4.04226520972055	4.0329521644097	4.03760868706513
3.82375776096224	3.84669125819263	3.90098398852437	3.97241736988915	3.86066082615891	3.8932564847469
3.66012355419488	3.7023390558744	3.75105069734067	3.86531734881434	3.70699557852983	3.75356080508409
3.52693292077959	3.57195642152245	3.62530019505756	3.74890428242867	3.59058251214416	3.632491216043
3.40135318070232	3.45088683248135	3.51331424659284	3.62783469338757	3.47882596841392	3.53936076293446
3.29860612063909	3.35309985671739	3.40897812858252	3.53470424027904	3.3717259473391	3.44623030982593];
endpointx = [-1.35507111287708	-1.34701203456058	-1.31831348487693	-1.29113376269546	-1.34235551190515	-1.3330424665943
-1.61969164477555	-1.61709034857533	-1.59399734466959	-1.55655555405478	-1.61709034857533	-1.60777730326448
-1.81376942489497	-1.79403820948155	-1.77778654031412	-1.76609907354899	-1.78938168682612	-1.78006864151527
-1.9659872916553	-1.9430469344552	-1.93255638927795	-1.90579475321179	-1.9430469344552	-1.92907736648892
-0.105123870510239	-0.089750917595352	-0.070032589947512	-0.038529168385657	-0.080437872284499	-0.066468304318218
-0.23831450392553	-0.215477029291875	-0.201507461325593	-0.159598757426754	-0.206163983981021	-0.19219441601474];
endpointx(5:6,:) = endpointx(5:6,:) - 2.;
waistz = [3.59162383419786	3.57661294417788	3.63980884524802	3.52539119496818	3.56729989886702	3.57195642152245
3.35568782067422	3.38103899264995	3.40281853717207	3.42294769654879	3.34844333406197	3.38569551530538
2.85336886036512	2.83156931930959	2.88530685469929	3.31119115281855	2.9200432497627	2.93401281772898
2.5717658068585	2.62202579981539	2.57576715677165	2.89210411383014	2.58011709591655	2.77569104744447
2.37007713340106	2.38919966704405	2.43576406509694	2.59408666388283	2.45439098422003	2.5894301412274
2.2130812650179	2.24484746472582	2.32400834986808	2.46370402953088	2.31935182721265	2.42179532563204];
waistx = [-1.17445447440546	-1.16540765099893	-1.17321685587644	-1.16075112834351	-1.17006417365436	-1.16540765099893
-1.29622867790984	-1.30044680800631	-1.30380387786242	-1.29579028535088	-1.29579028535088	-1.29579028535088
-1.45225199133918	-1.45411205563539	-1.448900611266	-1.43082944235826	-1.44945553297997	-1.44479901032454
-1.60446985809951	-1.59846425795362	-1.59399734466959	-1.54724250874393	-1.60312078060905	-1.57518164467649
-1.76049317152885	-1.75212950558271	-1.73350355462779	-1.68693818840673	-1.73815993761643	-1.70556427902844
-1.91851621429888	-1.90113823055636	-1.88251213993466	-1.81266430010325	-1.89182518524551	-1.83129039072496];
vortexx = [-1.15162181897612	-1.15143808303265	-1.15387063867637	-1.14678156037723	-1.15609460568808	-1.15143808303265
-1.31145046458587	-1.30975985331716	-1.30864043564254	-1.29579028535088	-1.30510333066174	-1.30510333066174
-1.46366833134621	-1.45876857829082	-1.45857372682624	-1.43548596501369	-1.46342510094625	-1.45411205563539
-1.61588619810654	-1.6124338259199	-1.60367046022982	-1.57052512202106	-1.60777730326448	-1.5938077352982
-1.76429861819786	-1.75212950558271	-1.74281659276547	-1.70090775637301	-1.74747298292728	-1.71953384699472
-1.90129469828216	-1.89182518524551	-1.8731990946238	-1.82663386806953	-1.88251213993466	-1.84060343603581];
endpointz2 = [4.04203457882129	4.0337807256425	4.05028843200007	4.04616150541068	4.03790765223189	4.04203457882129
3.8191805429941	3.84394210253045	3.89759214819255	3.9801306799804	3.86044980888802	3.89480111996183
3.66235733259719	3.69537274531233	3.75314971756382	3.86870366206681	3.70775352508051	3.76261756531314
3.52204182855785	3.57156494763056	3.62934191988205	3.75314971756382	3.59219958057752	3.64782779362364
3.40236095746547	3.45601100312757	3.51791490196846	3.63759577306084	3.47664563607454	3.55043041158407
3.29093393955188	3.34871091180337	3.41474173723365	3.53854953491542	3.37347247133973	3.45651150747448];
waistz2 = [3.46426485630636	3.42712251700183	3.48902641584271	3.4931533424321	3.53854953491542	3.47664563607454
3.13823765574436	3.1712530684595	3.20426848117464	3.27442623319431	3.14649150892315	3.19562642242576
2.93601825286414	2.96903366557928	2.96903366557928	3.05569912395652	2.96490673898988	2.99735242071649
2.61824490548093	2.77094118928844	2.80395660200358	2.91125669332778	2.77506811587784	2.83038548007722
2.16428298064777	2.58935641935518	2.57284871299761	2.77094118928844	2.53983330028247	2.69124636287783
1.97857128412511	2.11063293498567	2.23444073266744	2.62649875865971	2.12714064134324	2.52775790016854];
waisty2 = [0.221551564776256	0.217424638186864	0.213297711597471	0.221551564776256	0.225678491365648	0.225678491365648
0.217424638186864	0.213297711597471	0.221551564776256	0.225678491365648	0.217424638186864	0.219632924300258
0.213297711597471	0.217424638186864	0.217424638186864	0.229805417955041	0.217424638186864	0.219633104165144
0.19266307865051	0.200916931829294	0.213297711597471	0.229805417955041	0.205043858418687	0.219633104165144
0.209170785008079	0.188536152061118	0.200916931829294	0.229805417955041	0.19266307865051	0.212676148305174
0.209170785008079	0.209170785008079	0.209170785008079	0.217424638186864	0.213297711597471	0.20224071451522];
crestz2 = [3.71600737825929	3.74076893779564	3.73664201120625	3.74489586438504	3.71600737825929	3.72426123143808
3.50140719561089	3.51378797537907	3.57569187421995	3.62934191988205	3.53442260832603	3.55738845498174
3.2785531597837	3.29918779273066	3.38172632451851	3.48077256266393	3.34458398521398	3.39042042680477
3.31982242567763	3.3899801776973	3.2249031141216	3.35696476498216	3.41886866382304	3.25475978753536
3.10522224302922	3.20839540776403	3.30744164590945	3.24553774706856	3.24966467365796	3.16084088342577
2.91538361991718	3.03919141759895	3.14236458233376	3.13823765574436	3.07633375690348	3.14692697170583];
cresty2 = [0.258693904080787	0.250440050902002	0.24631312431261	0.24631312431261	0.258693904080787	0.254566977491395
0.320597802921672	0.31647087633228	0.299963169974711	0.287582390206534	0.320597802921672	0.306594951356984
0.361867068815596	0.365993995404988	0.361867068815596	0.324724729511065	0.357740142226203	0.355293743434551
0.452659453782227	0.423770967656481	0.399009408120127	0.374247848583773	0.415517114477696	0.397035478594368
0.522817205801897	0.493928719676151	0.452659453782227	0.423770967656481	0.485674866497366	0.445734169614155
0.568213398285213	0.547578765338251	0.518690279212504	0.45678638037162	0.547578765338251	0.490954382703957];
%%
Reynolds = [2000, 1000, 1000, 1000, 800, 400];
Radius = [0.05, 0.05, 0.06, 0.08, 0.05, 0.05];
Height = [0.2, 0.2, 0.2, 0.2, 0.2, 0.2];
Ratio = Radius./Height;
Gamma = [2., 1., 1., 1., 1., 1.];
 tscale =0.2^2 / 1;
time = [4:4:24]'*0.1/tscale;
plottype = {'+b','^b', '^r', '^k', 'sb', 'ob'};
DS = [1, 2, 5,6,3,4];
%% vortex column location
columnx = (vortexx + 1.) / Height(1);
figure;
for ii=DS
    plot(time, columnx(:,ii)  , plottype{ii});
    hold on;
end
plot([0 time(6)], [0 -1./4./pi*time(6)]  , 'r-');
legend('Re 2000, \sigma/h 0.25','1000,0.25', '800, 0.25', '400, 0.25', '1000, 0.3', '1000, 0.4', 'speed U_i_0', 'Location', 'Best');
xlabel('t\Gamma/h^2')
ylabel('x/h')
axis([0 60 -5 0])
title('x displacement of vortex column')
%% vortex leg root location
footx = (endpointx + 1.) / Height(1);
figure;
for ii=DS
    plot(time, footx(:,ii)  , plottype{ii});
    hold on;
end
plot([0 time(6)], [0 -1./2./pi*time(6)]  , 'r-');
legend('Re 2000, \sigma/h 0.25','1000,0.25', '800, 0.25', '400, 0.25', '1000, 0.3', '1000, 0.4', 'speed 2U_i_0', 'Location', 'Best');
xlabel('t\Gamma/h^2')
ylabel('x/h')
axis([0 60 -6 0])
title('x displacement of vortex foot')
%% leg location
legz = (4. - (endpointz+endpointz2)*0.5) ./ Height(1);
figure;
for ii=DS
    plot(time, legz(:,ii) , plottype{ii});
    hold on;
end
legend('Re 2000, \sigma/h 0.25','1000,0.25', '800, 0.25', '400, 0.25', '1000, 0.3', '1000, 0.4', 'Location', 'Best');
xlabel('t\Gamma/h^2')
ylabel('z/h')
title('z displacement of vortex foot')
axis([0 60 -1 4])
%% modeling leg z location
legz = (4. - (endpointz+endpointz2)*0.5) ./ Height(1);
velocity = (legz(2:6,:) - legz(1:5,:))/(time(2) - time(1));
figure;
for ii=DS
%     realratio1 = sqrt(1*2./Reynolds(ii)*time + Ratio(ii)^2);
    timemid = (time(1:5) + time(2:6))*0.5;
    plot(timemid, velocity(:,ii), plottype{ii});
    hold on;
end
legend('Re 2000, \sigma/h 0.25','1000,0.25', '800, 0.25', '400, 0.25', '1000, 0.3', '1000, 0.4', 'Location', 'Best');
xlabel('t\Gamma/h^2')
ylabel('h\Delta z/\Delta t \Gamma')
title('z velocity of vortex foot')
axis([0 60 0.02 0.12])
%% wave length
wavelen = ((endpointz+endpointz2)*0.5 - min(waistz2,waistz)) ./ Height(1);
error = (max(waistz2,waistz) - min(waistz2,waistz)) ./ Height(1);
figure;
for ii=DS
    plot(time, wavelen(:,ii)  , plottype{ii});
    hold on;
end
legend('Re 2000, \sigma/h 0.25','1000,0.25', '800, 0.25', '400, 0.25', '1000, 0.3', '1000, 0.4', 'Location', 'Best');
xlabel('t\Gamma/h^2')
ylabel('\lambda/h')
title('wavelength')
axis([0 60 2 7])
%% wave length 2
wavelen = ((endpointz+endpointz2)*0.5 - crestz2) ./ Height(1);
figure;
for ii=DS
    plot(time, wavelen(:,ii)  , plottype{ii});
    hold on;
end
legend('Re 2000, \sigma/h 0.25','1000,0.25', '800, 0.25', '400, 0.25', '1000, 0.3', '1000, 0.4', 'Location', 'Best');
xlabel('t\Gamma/h^2')
ylabel('\lambda/h')
title('wavelength')
axis([0 60 0.2 2.2])
%% wave height 2
wavelen =cresty2 ./ Height(1);
figure;
for ii=DS
    plot(time, wavelen(:,ii) , plottype{ii});
    hold on;
end
legend('Re 2000, \sigma/h 0.25','1000,0.25', '800, 0.25', '400, 0.25', '1000, 0.3', '1000, 0.4', 'Location', 'Best');
xlabel('t\Gamma/h^2')
ylabel('\Lambda/h')
title('crest height')
% axis([0 60 0.2 2.2])