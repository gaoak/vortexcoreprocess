%%
clear;
clc;
close all;
setPlotParameters;
endpoint = [3.99251145974858,4.00901916610615,4.02139994587432,4.01727301928493,3.85632288229863,4.07917691812582;
3.765530497332,3.8191805429941,3.86457673547742,3.90997292796073,3.6582304060078,3.91409985455012;
3.61283421352448,3.66235733259719,3.70362659849111,3.75727664415321,3.4972802690215,3.76140357074261;
3.45601100312757,3.51791490196846,3.57569187421995,3.64172269965023,3.38172632451851,3.62521499329266;
3.31982242567763,3.3858532511079,3.44775714994879,3.51378797537907,3.27442623319431,3.50140719561089];
crest = [3.66235733259719,3.70775352508051,3.73664201120625,3.75727664415321,3.69537274531233,3.67886503895476;
3.42299559041243,3.4931533424321,3.55505724127299,3.59632650716691,3.48077256266393,3.42712251700183;
3.29918779273066,3.30744164590945,3.37347247133973,3.43950329677,3.27029930660492,3.19601462799586;
3.19188770140646,3.20014155458525,3.22077618753221,3.2785531597837,3.08871453667166,2.98554137193685;
2.96903366557928,3.04744527077773,3.10109531643983,3.13823765574436,2.9566528858111,2.72554499680513];
t = [0.5:0.5:2.5]';
sigma=[0.05,0.06,0.07,0.08,0.05,0.05]';
height=[0.2,0.2,0.2,0.2,0.1,0.3]';
gamma=[1.,1.,1.,1.,1.,1.]';
nu=[0.001,0.001,0.001,0.001,0.001]';
tscale = height.^2./gamma;
pi1 = sigma./height;
linetype={'bo-', 'k^-', 'kv-', 'k<-', 'b+', 'b*'}
%%
figure;
for ii=1:1:6
    plot(t/tscale(ii), pi1(ii) * (4. - endpoint(:,ii))/height(ii), linetype{ii})
    hold on;
end
axis([0 60 0 2])
ylabel('spanwise displacement * h \sigma')
xlabel('t')
legend('\sigma/h=0.25','0.3','0.35','0.4','0.5','0.17','Location', 'Best')
%%
figure;
for ii=1:1:6
    plot(t/tscale(ii), pi1(ii) * (endpoint(:,ii) - crest(:,ii))/height(ii), linetype{ii})
    hold on;
end
axis([0 60 0 2])
ylabel('\lambda / h')
xlabel('t')
legend('\sigma/h=0.25','0.3','0.35','0.4','0.5','0.17','Location', 'Best')
%%
figure;
for ii=1:1:6
    plot(t, 2. * (endpoint(:,ii) - crest(:,ii))/sigma(ii), linetype{ii})
    hold on;
end
ylabel('\lambda/\sigma')
xlabel('t')
axis([0.5 2.5 0 30])